<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png" />
    <meta name="viewport" content="width=device-width, initial-scale=0.5" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.x.x/dist/tailwind.min.css">
    <title>Sales app</title>
  </head>
  <body>
    <div id="app">

      <!--HEADER-->
    <header class="sticky top-0 z-50" x-data="{ open: false }">
      <nav class="bg-gray-500 border-gray-200">
        <div class="max-w-screen-xl flex items-center justify-between mx-auto p-4">
          <a href="/" class="flex items-center space-x-3 rtl:space-x-reverse">
            <img src="/online-shop.png" class="h-8" alt="Flowbite Logo" />
            <span class="text-2xl font-semibold text-white">SwiftCart</span>
          </a>
          <button
            @click="open = !open"
            class="md:hidden p-2 w-10 h-10 text-sm text-white rounded-lg hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200"
            aria-controls="navbar-dropdown"
            :aria-expanded="open"
          >
            <span class="sr-only">Open main menu</span>
            <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M1 1h15M1 7h15M1 13h15"/>
            </svg>
          </button>
          <div :class="open ? 'block' : 'hidden'" class="w-full md:block md:w-auto" id="navbar-dropdown">
            <ul class="flex flex-col md:flex-row md:space-x-8 p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-500 md:border-0 md:mt-0 font-medium">
              <li><a href="#" class="block py-2 px-3 text-white rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700">Wishlist</a></li>
              <li class="relative hidden md:block lg:block">
                <a href="#" class="block">
                  <div class="absolute left-3 -top-4 t-0">
                    <p class="flex h-2 w-2 items-center justify-center p-3 text-xs text-white bg-red-500 rounded-full">2</p>
                  </div>
                  <svg class="h-6 w-6 stroke-white cursor-pointer" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z"/>
                  </svg>
                </a>
              </li>
              <li class="lg:hidden md:hidden"><a href="#" class="block py-2 px-3 text-white rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700">Cart</a></li>
              <li><a href="login" class="block py-2 px-3 text-white rounded hover:bg-gray-100 md:hover:bg-transparent md:hover:text-blue-700">Login</a></li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    </div>

    <!--MODEM-->
   <div x-data="filterComponent()">
    <template x-if="error">
      <div class="text-red-500 p-4">
          <p x-text="error"></p>
      </div>
  </template>
  <form>
    <div class="flex lg:w-[31.25rem] sm:w-[95%] md:w-full relative">
        <button
            @click="toggleDropdown"
            id="dropdown-button"
            class="flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-center text-gray-900 bg-gray-100 border border-gray-300 rounded-s-lg hover:bg-gray-200"
            type="button"
        >
        <span x-text="filterItem"></span>
        <svg
            class="w-2.5 h-2.5 ms-2.5"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 10 6"
        >
        <path
        stroke="currentColor"
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="m1 1 4 4 4-4"
    />
</svg>
</button>
<div
    x-ref="dropdown"
    x-show="dropdownOpen"
    class="z-10 absolute top-[100%] bg-white divide-y divide-gray-100 rounded-lg shadow w-44"
>
<ul class="py-2 text-sm text-gray-700">
  <li
      @click="handleFilter('All categories')"
      class="inline-flex w-full px-4 py-2 hover:bg-gray-100 cursor-pointer"
  >
  All categories
</li>
<template x-for="category in categories" :key="category">
  <li>
      <button
          @click="handleFilter(category)"
          type="button"
          class="inline-flex w-full px-4 py-2 hover:bg-gray-100"
      >
          <span x-text="category"></span>
      </button>
  </li>
</template>
</ul>
</div>
<div class="relative w-full">
  <input
      type="search"
      id="search-dropdown"
      name="searchInput"
      class="p-2.5 w-full z-20 text-sm text-gray-900 bg-gray-50 rounded-e-lg border-s-gray-50 border-s-2 border border-gray-300 focus:ring-blue-500 focus:border-blue-500"
      placeholder="Search products..."
      x-model="searchTerm"
      @input="handleSearch"
  />
  <button
  type="submit"
  class="absolute top-0 end-0 p-2.5 text-sm font-medium h-full text-white bg-blue-700 rounded-e-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300"
>
<svg
class="w-4 h-4"
aria-hidden="true"
xmlns="http://www.w3.org/2000/svg"
fill="none"
viewBox="0 0 20 20"
>
<path
stroke="currentColor"
stroke-linecap="round"
stroke-linejoin="round"
stroke-width="2"
d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"
/>
</svg>
<span class="sr-only">Search</span>
</button>
</div>
</div>
</form>
</div> 

<!--SORT-->
<div x-data="sortComponent()">
  <div class="flex justify-end sm:w-[95%] max-w-[21rem] md:w-full">
      <label for="sort" class="w-20 my-auto font-semibold">
          Sort by: 
      </label>
      <select
      @change="handleSort"
      x-model="sorting"
      id="sort"
      class="p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-e-lg border-s-gray-50 border-s-2 border border-gray-300 focus:ring-blue-500 focus:border-blue-500"
  >
  <option value="default">Default</option>
  <option value="low">Price: Low to High</option>
  <option value="high">Price: High to Low</option>
</select>
</div>
</div>

<!--Products-->
<div x-data="productComponent()" x-init="init">
  <!-- Loading Skeleton -->
  <div x-show="loading" class="grid justify-center">
      <div class="lg:max-h-[130rem] max-w-xl mx-auto grid gap-4 grid-cols-1 lg:grid-cols-4 md:grid-cols-2 items-center lg:max-w-none my-4">
          <template x-for="index in 20" :key="index">
              <div class="bg-white max-w-sm p-4 border border-gray-200 rounded shadow animate-pulse md:p-6 dark:border-gray-700">
                  <div class="flex items-center justify-center h-48 mb-4 bg-gray-300 rounded dark:bg-gray-700">
                    <svg class="w-10 h-10 text-gray-200 dark:text-gray-600" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 20">
                      <path d="M14.066 0H7v5a2 2 0 0 1-2 2H0v11a1.97 1.97 0 0 0 1.934 2h12.132A1.97 1.97 0 0 0 16 18V2a1.97 1.97 0 0 0-1.934-2ZM10.5 6a1.5 1.5 0 1 1 0 2.999A1.5 1.5 0 0 1 10.5 6Zm2.221 10.515a1 1 0 0 1-.858.485h-8a1 1 0 0 1-.9-1.43L5.6 10.039a.978.978 0 0 1 .936-.57 1 1 0 0 1 .9.632l1.181 2.981.541-1a.945.945 0 0 1 .883-.522 1 1 0 0 1 .879.529l1.832 3.438a1 1 0 0 1-.031.988Z"/>
                      <path d="M5 5V.13a2.96 2.96 0 0 0-1.293.749L.879 3.707A2.98 2.98 0 0 0 .13 5H5Z"/>
                  </svg>
</div>
<script>
  function filterComponent() {
      return {
          categories: [],
          filterItem: 'Select category',
          error: null,
          searchTerm: '',
          dropdownOpen: false,
          async init() {
              try {
                  const response = await fetch('https://fakestoreapi.com/products/categories');
                  if (!response.ok) throw new Error('Failed to fetch categories');
                  this.categories = await response.json();
              } catch (error) {
                  this.error = error.message;
              }
          },
          toggleDropdown() {
              this.dropdownOpen = !this.dropdownOpen;
          },
          handleFilter(category) {
              this.filterItem = category;
              this.dropdownOpen = false;
           
              this.fetchProducts(); 
          },
          async handleSearch(event) {
              this.searchTerm = event.target.value;
              try {
                  const response = await fetch(`https://fakestoreapi.com/products?search=${this.searchTerm}`);
                  if (!response.ok) throw new Error('Failed to search products');
                  const data = await response.json();
              } catch (error) {
                  this.error = error.message;
              }
          }
      }
  }

  document.addEventListener('alpine:init', () => {
      Alpine.data('filterComponent', filterComponent);
  });
  //Component sort
  function sortComponent() {
            return {
                sorting: 'default',
                async handleSort(event) {
                    this.sorting = event.target.value;
                    this.sortProducts();
                },
                async sortProducts() {
                    try {
                        const response = await fetch(`https://fakestoreapi.com/products?sort=${this.sorting}`);
                        if (!response.ok) throw new Error('Failed to sort products');
                        const data = await response.json();
                    
                    } catch (error) {
                        console.error(error.message);
                    }
                },
            };
        }

        document.addEventListener('alpine:init', () => {
            Alpine.data('sortComponent', sortComponent);
        });


</script>
   <script type="module" src="src/main.js"></script>
  </body>
</html>
